-- 1. What is the total sales revenue (SUM(total_price)) overall?
SELECT SUM(Revenue) AS Total_Revenue
from retail;

-- 2. What is the average unit price and average freight cost?
SELECT
AVG(Unit_Price) AS Avg_Unit_Price,
AVG(Freight_Price) AS Avg_Freight_Price
From retail;

-- 3. Which product categories contribute the most to revenue?
SELECT Product_Category, Revenue
FROM retail
ORDER BY Revenue DESC
Limit 5;

-- 4. Which products have the highest sales quantities?
SELECT ProductID, Quantity
FROM retail
ORDER BY Quantity DESC
Limit 10; 

-- 5. What is the average product score per category?
SELECT 
Product_Category, AVG(Product_Score) AS Avg_Product_Score
From retail
GROUP BY Product_Category
ORDER BY Avg_Product_Score;

-- 6. Which products/categories have the highest customer engagement (based on customers count)?
SELECT Product_Category, Customers
FROM retail
ORDER BY Customers DESC
Limit 1;

-- 7. Is there any relationship between product weight and freight price?
SELECT Product_Weight, Freight_Price
FROM retail
Order by product_weight DESC;

-- 8. What are the monthly sales trends (using month + year)?
SELECT 
month,
year, 
ROUND(SUM(Total_Price), 2) AS Total_Sales , 
SUM(Quantity) AS Total_Quantity,
COUNT(DISTINCT ProductID) AS Unique_Customers
From retail
Group by Year, Month
ORDER BY Year, Month;

-- 9. Which months had the highest/lowest revenue?
SELECT Month, Year, Revenue 
from retail
ORDER BY Revenue ASC
LImit 5;

SELECT Month, Year, Revenue 
from retail
ORDER BY Revenue DESC
Limit 5;

-- 10. How do sales compare between weekdays, weekends, and holidays?
SELECT 
     CASE
     WHEN Holiday = 1 THEN 'Holiday'
     WHEN Weekend = 1 THEN 'Weekend'
     ELSE Weekday
     END AS Day_Type,
     ROUND(SUM(Total_Price), 2) AS Total_Sales,
     SUM(Quantity) AS Total_Quantity
     FROM retail
     GROUP BY Day_Type
     ORDER BY Total_Sales DESC;
     
     SELECT 
    CASE
        WHEN holiday > 1 THEN 'Holiday'
        WHEN weekend > 1 THEN 'Weekend'
        ELSE 'Weekday'
    END AS day_type,
    ROUND(SUM(total_price), 2) AS total_sales,
    SUM(quantity) AS total_quantity,
    ROUND(SUM(total_price) / NULLIF(SUM(quantity), 0), 2) AS avg_order_value
FROM retail
GROUP BY day_type
ORDER BY total_sales DESC;

-- 12. What is the effect of lag price on current sales volume?
SELECT 
Lag_Price, SUM(Quantity) AS Total_Quantity
From retail
GROUP BY Lag_Price
Order by Lag_Price
